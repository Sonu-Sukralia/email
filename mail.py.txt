"""
Outlook Email Notifier - Standalone Script
Monitors Outlook inbox and shared mailboxes and shows desktop notifications
"""

import win32com.client
import time
from datetime import datetime, timedelta
import winsound
import sys

class OutlookMonitor:
    def __init__(self):
        self.outlook = None
        self.namespace = None
        self.last_check_time = {}
        
        # Configuration
        self.check_interval = 30  # seconds
        self.shared_mailboxes = [
            '4data@cap.com',
            'edocaspian@cap.com',
            'edolasr@cap.com'
        ]  # Your shared mailboxes
        self.play_sound = True
        
    def connect_outlook(self):
        """Connect to Outlook application"""
        try:
            self.outlook = win32com.client.Dispatch("Outlook.Application")
            self.namespace = self.outlook.GetNamespace("MAPI")
            print("âœ… Connected to Outlook successfully")
            return True
        except Exception as e:
            print(f"âŒ Error connecting to Outlook: {e}")
            print("Make sure Outlook is running!")
            return False
    
    def show_notification(self, subject, sender, mailbox=None):
        """Show Windows notification"""
        try:
            from win10toast import ToastNotifier
            toaster = ToastNotifier()
            
            mailbox_label = f" [{mailbox}]" if mailbox else ""
            title = f"ğŸ“§ New Email{mailbox_label}"
            message = f"From: {sender}\nSubject: {subject}"
            
            toaster.show_toast(
                title,
                message,
                duration=5,
                threaded=True
            )
        except ImportError:
            # Fallback to console if win10toast not available
            mailbox_label = f" [{mailbox}]" if mailbox else ""
            print(f"\n{'='*60}")
            print(f"ğŸ“§ NEW EMAIL{mailbox_label}")
            print(f"From: {sender}")
            print(f"Subject: {subject}")
            print(f"Time: {datetime.now().strftime('%H:%M:%S')}")
            print(f"{'='*60}\n")
    
    def play_notification_sound(self):
        """Play notification sound"""
        if self.play_sound:
            try:
                winsound.PlaySound("SystemAsterisk", winsound.SND_ALIAS)
            except:
                print("ğŸ”” *ding*")
    
    def check_inbox(self, folder_name=None):
        """Check inbox for new emails"""
        try:
            if folder_name:
                # Check shared mailbox
                try:
                    inbox = self.namespace.Folders(folder_name).Folders("Inbox")
                    mailbox_key = folder_name
                except:
                    print(f"âš ï¸  Could not access mailbox: {folder_name}")
                    return
            else:
                # Check primary inbox
                inbox = self.namespace.GetDefaultFolder(6)  # 6 = olFolderInbox
                mailbox_key = "primary"
            
            # Get current time
            now = datetime.now()
            
            # Initialize last check time if not exists
            if mailbox_key not in self.last_check_time:
                self.last_check_time[mailbox_key] = now - timedelta(seconds=self.check_interval)
                print(f"ğŸ“¬ Monitoring: {folder_name if folder_name else 'Primary Inbox'}")
                return  # Skip first check to avoid spam
            
            # Get unread messages
            messages = inbox.Items
            messages.Sort("[ReceivedTime]", True)
            
            new_count = 0
            for message in messages:
                try:
                    if message.UnRead:
                        received_time = message.ReceivedTime
                        
                        # Convert to datetime if needed
                        if not isinstance(received_time, datetime):
                            try:
                                received_time = datetime.strptime(str(received_time), '%Y-%m-%d %H:%M:%S')
                            except:
                                continue
                        
                        # Check if received after last check
                        if received_time > self.last_check_time[mailbox_key]:
                            self.show_notification(
                                message.Subject,
                                message.SenderName,
                                folder_name
                            )
                            new_count += 1
                except:
                    continue
            
            if new_count > 0:
                self.play_notification_sound()
            
            # Update last check time
            self.last_check_time[mailbox_key] = now
            
        except Exception as e:
            print(f"âŒ Error checking inbox: {e}")
    
    def configure(self):
        """Interactive configuration"""
        print("\n" + "="*60)
        print("OUTLOOK EMAIL NOTIFIER - CONFIGURATION")
        print("="*60)
        
        # Check interval
        try:
            interval = input(f"\nCheck interval in seconds (current: {self.check_interval}): ").strip()
            if interval:
                self.check_interval = int(interval)
        except:
            pass
        
        # Shared mailboxes
        print("\nShared mailboxes (enter names as they appear in Outlook)")
        print("Current:", self.shared_mailboxes if self.shared_mailboxes else "None")
        
        while True:
            mailbox = input("Add shared mailbox (or press Enter to finish): ").strip()
            if not mailbox:
                break
            if mailbox not in self.shared_mailboxes:
                self.shared_mailboxes.append(mailbox)
                print(f"  âœ… Added: {mailbox}")
        
        # Sound
        sound = input(f"\nPlay notification sound? (Y/n, current: {'Y' if self.play_sound else 'n'}): ").strip().lower()
        if sound in ['n', 'no']:
            self.play_sound = False
        elif sound in ['y', 'yes', '']:
            self.play_sound = True
        
        print("\nâœ… Configuration saved!")
        print("="*60 + "\n")
    
    def monitor(self):
        """Main monitoring loop"""
        if not self.connect_outlook():
            return
        
        # Ask for configuration
        config = input("\nWould you like to configure settings? (y/N): ").strip().lower()
        if config in ['y', 'yes']:
            self.configure()
        
        print(f"\nğŸš€ Starting email monitor...")
        print(f"â±ï¸  Check interval: {self.check_interval} seconds")
        print(f"ğŸ“§ Monitoring: Primary Inbox")
        for mailbox in self.shared_mailboxes:
            print(f"ğŸ“§ Monitoring: {mailbox}")
        print("\nâŒ¨ï¸  Press Ctrl+C to stop\n")
        
        try:
            while True:
                # Check primary inbox
                self.check_inbox()
                
                # Check shared mailboxes
                for mailbox in self.shared_mailboxes:
                    self.check_inbox(mailbox)
                
                time.sleep(self.check_interval)
                
        except KeyboardInterrupt:
            print("\n\nâ¹ï¸  Monitor stopped by user")
        except Exception as e:
            print(f"\nâŒ Monitor error: {e}")

def main():
    print("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         OUTLOOK EMAIL NOTIFIER FOR VS CODE                â•‘
â•‘         Standalone Python Script                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    """)
    
    monitor = OutlookMonitor()
    monitor.monitor()

if __name__ == "__main__":

    main()








































import React, { useState } from 'react';
import { Bell, Mail, Check, Copy, AlertCircle, Monitor, Download } from 'lucide-react';

export default function OutlookNotifierGuide() {
  const [copiedSection, setCopiedSection] = useState(null);

  const copyToClipboard = (text, section) => {
    navigator.clipboard.writeText(text);
    setCopiedSection(section);
    setTimeout(() => setCopiedSection(null), 2000);
  };

  const pythonScript = `"""
Outlook Email Notifier - Standalone Script
Monitors Outlook inbox and shared mailboxes and shows desktop notifications
"""

import win32com.client
import time
from datetime import datetime, timedelta
import winsound
import sys

class OutlookMonitor:
    def __init__(self):
        self.outlook = None
        self.namespace = None
        self.last_check_time = {}
        
        # Configuration
        self.check_interval = 15  # seconds
        self.shared_mailboxes = [
            '4data@cap.com',
            'edocaspian@cap.com',
            'edolasr@cap.com'
        ]  # Your shared mailboxes
        self.play_sound = True
        
    def connect_outlook(self):
        """Connect to Outlook application"""
        try:
            self.outlook = win32com.client.Dispatch("Outlook.Application")
            self.namespace = self.outlook.GetNamespace("MAPI")
            print("âœ… Connected to Outlook successfully")
            return True
        except Exception as e:
            print(f"âŒ Error connecting to Outlook: {e}")
            print("Make sure Outlook is running!")
            return False
    
    def show_notification(self, subject, sender, mailbox=None):
        """Show Windows notification"""
        try:
            from win10toast import ToastNotifier
            toaster = ToastNotifier()
            
            mailbox_label = f" [{mailbox}]" if mailbox else ""
            title = f"ğŸ“§ New Email{mailbox_label}"
            message = f"From: {sender}\\nSubject: {subject}"
            
            toaster.show_toast(
                title,
                message,
                duration=5,
                threaded=True
            )
        except ImportError:
            # Fallback to console if win10toast not available
            mailbox_label = f" [{mailbox}]" if mailbox else ""
            print(f"\\n{'='*60}")
            print(f"ğŸ“§ NEW EMAIL{mailbox_label}")
            print(f"From: {sender}")
            print(f"Subject: {subject}")
            print(f"Time: {datetime.now().strftime('%H:%M:%S')}")
            print(f"{'='*60}\\n")
    
    def play_notification_sound(self):
        """Play notification sound"""
        if self.play_sound:
            try:
                winsound.PlaySound("SystemAsterisk", winsound.SND_ALIAS)
            except:
                print("ğŸ”” *ding*")
    
    def check_inbox(self, folder_name=None):
        """Check inbox for new emails"""
        try:
            if folder_name:
                # Check shared mailbox
                try:
                    inbox = self.namespace.Folders(folder_name).Folders("Inbox")
                    mailbox_key = folder_name
                except:
                    print(f"âš ï¸  Could not access mailbox: {folder_name}")
                    return
            else:
                # Check primary inbox
                inbox = self.namespace.GetDefaultFolder(6)  # 6 = olFolderInbox
                mailbox_key = "primary"
            
            # Get current time
            now = datetime.now()
            
            # Initialize last check time if not exists
            if mailbox_key not in self.last_check_time:
                self.last_check_time[mailbox_key] = now - timedelta(seconds=self.check_interval)
                print(f"ğŸ“¬ Monitoring: {folder_name if folder_name else 'Primary Inbox'}")
                return  # Skip first check to avoid spam
            
            # Get unread messages
            messages = inbox.Items
            messages.Sort("[ReceivedTime]", True)
            
            new_count = 0
            for message in messages:
                try:
                    if message.UnRead:
                        received_time = message.ReceivedTime
                        
                        # Convert to datetime if needed
                        if not isinstance(received_time, datetime):
                            try:
                                received_time = datetime.strptime(str(received_time), '%Y-%m-%d %H:%M:%S')
                            except:
                                continue
                        
                        # Check if received after last check
                        if received_time > self.last_check_time[mailbox_key]:
                            self.show_notification(
                                message.Subject,
                                message.SenderName,
                                folder_name
                            )
                            new_count += 1
                except:
                    continue
            
            if new_count > 0:
                self.play_notification_sound()
            
            # Update last check time
            self.last_check_time[mailbox_key] = now
            
        except Exception as e:
            print(f"âŒ Error checking inbox: {e}")
    
    def configure(self):
        """Interactive configuration"""
        print("\\n" + "="*60)
        print("OUTLOOK EMAIL NOTIFIER - CONFIGURATION")
        print("="*60)
        
        # Check interval
        try:
            interval = input(f"\\nCheck interval in seconds (current: {self.check_interval}): ").strip()
            if interval:
                self.check_interval = int(interval)
        except:
            pass
        
        # Shared mailboxes
        print("\\nShared mailboxes (enter names as they appear in Outlook)")
        print("Current:", self.shared_mailboxes if self.shared_mailboxes else "None")
        
        while True:
            mailbox = input("Add shared mailbox (or press Enter to finish): ").strip()
            if not mailbox:
                break
            if mailbox not in self.shared_mailboxes:
                self.shared_mailboxes.append(mailbox)
                print(f"  âœ… Added: {mailbox}")
        
        # Sound
        sound = input(f"\\nPlay notification sound? (Y/n, current: {'Y' if self.play_sound else 'n'}): ").strip().lower()
        if sound in ['n', 'no']:
            self.play_sound = False
        elif sound in ['y', 'yes', '']:
            self.play_sound = True
        
        print("\\nâœ… Configuration saved!")
        print("="*60 + "\\n")
    
    def monitor(self):
        """Main monitoring loop"""
        if not self.connect_outlook():
            return
        
        # Ask for configuration
        config = input("\\nWould you like to configure settings? (y/N): ").strip().lower()
        if config in ['y', 'yes']:
            self.configure()
        
        print(f"\\nğŸš€ Starting email monitor...")
        print(f"â±ï¸  Check interval: {self.check_interval} seconds")
        print(f"ğŸ“§ Monitoring: Primary Inbox")
        for mailbox in self.shared_mailboxes:
            print(f"ğŸ“§ Monitoring: {mailbox}")
        print("\\nâŒ¨ï¸  Press Ctrl+C to stop\\n")
        
        try:
            while True:
                # Check primary inbox
                self.check_inbox()
                
                # Check shared mailboxes
                for mailbox in self.shared_mailboxes:
                    self.check_inbox(mailbox)
                
                time.sleep(self.check_interval)
                
        except KeyboardInterrupt:
            print("\\n\\nâ¹ï¸  Monitor stopped by user")
        except Exception as e:
            print(f"\\nâŒ Monitor error: {e}")

def main():
    print("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         OUTLOOK EMAIL NOTIFIER FOR VS CODE                â•‘
â•‘         Standalone Python Script                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    """)
    
    monitor = OutlookMonitor()
    monitor.monitor()

if __name__ == "__main__":
    main()`;

  const vscodeTaskJson = `{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Start Outlook Notifier",
      "type": "shell",
      "command": "python",
      "args": [
        "\${workspaceFolder}/outlook_notifier.py"
      ],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    }
  ]
}`;

  const readmeMd = `# Outlook Email Notifier for VS Code

Get desktop notifications for new emails in your Outlook inbox and shared mailboxes!

## Features
- ğŸ“§ Monitor primary inbox
- ğŸ“¬ Monitor shared mailboxes
- ğŸ”” Desktop notifications (Windows Toast)
- ğŸ”Š Sound alerts
- âš¡ Real-time monitoring
- ğŸ” No authentication needed (uses your logged-in Outlook)

## Requirements
- Windows OS
- Microsoft Outlook desktop application (must be running)
- Python 3.7+
- pywin32 package

## Installation

### 1. Install Python packages
\`\`\`bash
pip install pywin32
pip install win10toast  # Optional, for better notifications
\`\`\`

### 2. Download the script
Save \`outlook_notifier.py\` to your workspace or project folder.

### 3. Run from VS Code Terminal
\`\`\`bash
python outlook_notifier.py
\`\`\`

Or use VS Code Tasks (see below).

## Using VS Code Tasks

### Setup Task
1. Press \`Ctrl+Shift+P\` and type "Tasks: Configure Task"
2. Select "Create tasks.json from template"
3. Copy the task configuration provided
4. Save the file

### Run Task
- Press \`Ctrl+Shift+P\` â†’ "Tasks: Run Task" â†’ "Start Outlook Notifier"
- Or press \`Ctrl+Shift+B\` (if set as default build task)

The script will run in a dedicated VS Code terminal panel.

## Configuration

When you first run the script, it will ask if you want to configure settings:
- **Check interval**: How often to check for new emails (default: 30 seconds)
- **Shared mailboxes**: Names of shared mailboxes to monitor
- **Sound**: Enable/disable notification sound

You can also edit these settings directly in the script.

## How to Find Shared Mailbox Names

1. Open Outlook desktop application
2. Look at the folder list on the left
3. Shared mailboxes appear as separate accounts
4. Use the exact name as it appears in the folder list

Example: If you see "Sales Team - sales@company.com", use "Sales Team"

## Troubleshooting

### "Could not connect to Outlook"
- Make sure Outlook desktop application is running
- Restart Outlook and try again

### "Could not access mailbox"
- Check the mailbox name is exactly as it appears in Outlook
- Ensure you have permissions to access the shared mailbox
- Try accessing the mailbox in Outlook first

### No notifications appearing
- If win10toast is not installed, notifications will appear in the terminal
- Install win10toast for proper desktop notifications: \`pip install win10toast\`

## Keyboard Shortcuts

- **Ctrl+C**: Stop the monitor

## Tips

- Keep the terminal open while monitoring
- The script will skip the first check to avoid notification spam
- Adjust check interval based on your needs (minimum 10 seconds recommended)
- The script only notifies for unread emails received after it starts

## License
Free to use and modify
`;

  const folderStructure = `outlook-email-notifier/
â”‚
â”œâ”€â”€ outlook_notifier.py          # Main Python script
â”œâ”€â”€ README.md                     # Documentation (optional)
â”‚
â””â”€â”€ .vscode/                      # VS Code settings (optional)
    â””â”€â”€ tasks.json                # Task configuration

That's it! Just 1-2 files needed.`;

  const setupSteps = [
    {
      title: "1. Create Project Folder",
      description: "Create your project structure",
      steps: [
        "Create a folder named 'outlook-email-notifier' anywhere on your PC",
        "Open this folder in VS Code (File â†’ Open Folder)",
        "You're ready to add the files!"
      ]
    },
    {
      title: "2. Install Python Requirements",
      description: "Install required Python packages",
      command: "pip install pywin32 win10toast"
    },
    {
      title: "3. Create the Script",
      description: "Save the Python script",
      steps: [
        "Copy the outlook_notifier.py script below",
        "Save it in your project folder as 'outlook_notifier.py'",
        "Make sure Outlook desktop application is running"
      ]
    },
    {
      title: "4. Run the Script",
      description: "Choose one of these methods:",
      steps: [
        "Method A: Open VS Code terminal (Ctrl + `) and run: python outlook_notifier.py",
        "Method B: Set up a VS Code task (see tasks.json below) and press Ctrl+Shift+P â†’ 'Run Task'",
        "Method C: Double-click the .py file in File Explorer (if Python is associated)"
      ]
    },
    {
      title: "5. Optional: Create VS Code Task",
      description: "To run with one click from VS Code:",
      steps: [
        "Create a folder named '.vscode' in your project folder",
        "Inside .vscode, create a file named 'tasks.json'",
        "Copy the tasks.json content below",
        "Press Ctrl+Shift+P â†’ 'Tasks: Run Task' â†’ 'Start Outlook Notifier'"
      ]
    }
  ];

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
      <div className="max-w-5xl mx-auto">
        <div className="bg-white rounded-xl shadow-lg p-8 mb-8">
          <div className="flex items-center gap-3 mb-4">
            <Bell className="w-8 h-8 text-indigo-600" />
            <h1 className="text-3xl font-bold text-gray-800">Outlook Email Notifier - Standalone Script</h1>
          </div>
          <p className="text-gray-600 mb-4">
            A simple Python script that monitors your Outlook inbox and shows desktop notifications. Run it from VS Code terminal or as a background task!
          </p>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
            <div className="flex items-center gap-2 text-sm text-indigo-600 bg-indigo-50 p-3 rounded-lg">
              <Monitor className="w-4 h-4" />
              <span>Windows + Outlook</span>
            </div>
            <div className="flex items-center gap-2 text-sm text-green-600 bg-green-50 p-3 rounded-lg">
              <Check className="w-4 h-4" />
              <span>No authentication</span>
            </div>
            <div className="flex items-center gap-2 text-sm text-purple-600 bg-purple-50 p-3 rounded-lg">
              <Mail className="w-4 h-4" />
              <span>Shared mailboxes</span>
            </div>
          </div>
        </div>

        <div className="space-y-6">
          <div className="bg-white rounded-xl shadow-md p-6">
            <h2 className="text-xl font-semibold text-gray-800 mb-4">ğŸ“ Folder Structure</h2>
            <pre className="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono">
              <code>{folderStructure}</code>
            </pre>
            <div className="mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4">
              <p className="text-sm text-blue-800">
                <strong>ğŸ’¡ Tip:</strong> The .vscode folder and tasks.json are optional. You can run the script directly from the terminal without them.
              </p>
            </div>
          </div>

          {setupSteps.map((step, idx) => (
            <div key={idx} className="bg-white rounded-xl shadow-md p-6">
              <h2 className="text-xl font-semibold text-gray-800 mb-2">{step.title}</h2>
              <p className="text-gray-600 mb-4">{step.description}</p>
              {step.command && (
                <div className="bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm">
                  {step.command}
                </div>
              )}
              {step.steps && (
                <ul className="list-disc list-inside space-y-2 text-gray-700 mt-3">
                  {step.steps.map((s, i) => (
                    <li key={i} className="ml-4">{s}</li>
                  ))}
                </ul>
              )}
            </div>
          ))}

          <div className="bg-white rounded-xl shadow-md p-6">
            <div className="flex items-center justify-between mb-4">
              <h2 className="text-xl font-semibold text-gray-800">outlook_notifier.py</h2>
              <button
                onClick={() => copyToClipboard(pythonScript, 'python')}
                className="flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors"
              >
                {copiedSection === 'python' ? (
                  <>
                    <Check className="w-4 h-4" />
                    Copied!
                  </>
                ) : (
                  <>
                    <Copy className="w-4 h-4" />
                    Copy Code
                  </>
                )}
              </button>
            </div>
            <pre className="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm max-h-96">
              <code>{pythonScript}</code>
            </pre>
          </div>

          <div className="bg-white rounded-xl shadow-md p-6">
            <div className="flex items-center justify-between mb-4">
              <h2 className="text-xl font-semibold text-gray-800">.vscode/tasks.json (Optional)</h2>
              <button
                onClick={() => copyToClipboard(vscodeTaskJson, 'task')}
                className="flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors"
              >
                {copiedSection === 'task' ? (
                  <>
                    <Check className="w-4 h-4" />
                    Copied!
                  </>
                ) : (
                  <>
                    <Copy className="w-4 h-4" />
                    Copy Code
                  </>
                )}
              </button>
            </div>
            <p className="text-gray-600 mb-3 text-sm">
              Create this file to run the notifier as a VS Code task
            </p>
            <pre className="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm">
              <code>{vscodeTaskJson}</code>
            </pre>
          </div>

          <div className="bg-white rounded-xl shadow-md p-6">
            <div className="flex items-center justify-between mb-4">
              <h2 className="text-xl font-semibold text-gray-800">README.md</h2>
              <button
                onClick={() => copyToClipboard(readmeMd, 'readme')}
                className="flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors"
              >
                {copiedSection === 'readme' ? (
                  <>
                    <Check className="w-4 h-4" />
                    Copied!
                  </>
                ) : (
                  <>
                    <Copy className="w-4 h-4" />
                    Copy Code
                  </>
                )}
              </button>
            </div>
            <pre className="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm max-h-64">
              <code>{readmeMd}</code>
            </pre>
          </div>

          <div className="bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6">
            <h3 className="text-lg font-semibold text-green-800 mb-3 flex items-center gap-2">
              <Check className="w-5 h-5" />
              Why This Approach?
            </h3>
            <ul className="space-y-2 text-gray-700">
              <li><strong>âœ… Simple:</strong> Just a single Python script - no complex extension setup</li>
              <li><strong>âœ… Flexible:</strong> Run from terminal, VS Code task, or startup folder</li>
              <li><strong>âœ… No Authentication:</strong> Uses your logged-in Outlook directly via COM</li>
              <li><strong>âœ… Desktop Notifications:</strong> Native Windows toast notifications</li>
              <li><strong>âœ… Easy to Customize:</strong> Edit the script to add your own logic</li>
              <li><strong>âœ… Shared Mailboxes:</strong> Monitor multiple mailboxes at once</li>
            </ul>
          </div>

          <div className="bg-gradient-to-r from-blue-50 to-cyan-50 border-2 border-blue-200 rounded-xl p-6">
            <h3 className="text-lg font-semibold text-blue-800 mb-3">Quick Start Example</h3>
            <div className="bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-sm space-y-2">
              <div className="text-green-400"># Terminal 1 - Install packages</div>
              <div>pip install pywin32 win10toast</div>
              <div className="text-green-400 mt-4"># Terminal 2 - Run the script</div>
              <div>python outlook_notifier.py</div>
              <div className="text-green-400 mt-4"># Follow prompts to configure</div>
              <div className="text-yellow-400"># Leave terminal open, script runs in background</div>
            </div>
          </div>

          <div className="bg-gradient-to-r from-amber-50 to-orange-50 border-2 border-amber-300 rounded-xl p-6">
            <h3 className="text-lg font-semibold text-amber-800 mb-3 flex items-center gap-2">
              <AlertCircle className="w-5 h-5" />
              Requirements
            </h3>
            <ul className="space-y-2 text-gray-700">
              <li><strong>Windows OS:</strong> win32com only works on Windows</li>
              <li><strong>Outlook Desktop:</strong> Must be installed and running</li>
              <li><strong>Python 3.7+:</strong> With pywin32 package</li>
              <li><strong>Permissions:</strong> Access to mailboxes in Outlook</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  );
}


































"""
Outlook Email Notifier - Standalone Script
Monitors Outlook inbox and shared mailboxes and shows desktop notifications
"""

import win32com.client
import time
from datetime import datetime, timedelta
import winsound
import sys

class OutlookMonitor:
    def __init__(self):
        self.outlook = None
        self.namespace = None
        self.last_check_time = {}
        
        # Configuration
        self.check_interval = 15  # seconds
        self.primary_email = "sonu@cap.com"
        self.shared_mailboxes = [
            '4Data',
            'EDO LASR'
        ]
        self.play_sound = True
        
    def connect_outlook(self):
        """Connect to Outlook application"""
        try:
            self.outlook = win32com.client.Dispatch("Outlook.Application")
            self.namespace = self.outlook.GetNamespace("MAPI")
            print("âœ… Connected to Outlook successfully")
            return True
        except Exception as e:
            print(f"âŒ Error connecting to Outlook: {e}")
            print("Make sure Outlook is running!")
            return False
    
    def show_notification(self, subject, sender, mailbox=None):
        """Show Windows notification"""
        try:
            from win10toast import ToastNotifier
            toaster = ToastNotifier()
            
            if mailbox:
                mailbox_label = f" [{mailbox}]"
            else:
                mailbox_label = f" [{self.primary_email}]"
            
            title = f"ğŸ“§ New Email{mailbox_label}"
            message = f"From: {sender}\nSubject: {subject}"
            
            toaster.show_toast(
                title,
                message,
                duration=5,
                threaded=True
            )
        except ImportError:
            if mailbox:
                mailbox_label = f" [{mailbox}]"
            else:
                mailbox_label = f" [{self.primary_email}]"
            
            print(f"\n{'='*60}")
            print(f"ğŸ“§ NEW EMAIL{mailbox_label}")
            print(f"From: {sender}")
            print(f"Subject: {subject}")
            print(f"Time: {datetime.now().strftime('%H:%M:%S')}")
            print(f"{'='*60}\n")
    
    def play_notification_sound(self):
        """Play notification sound"""
        if self.play_sound:
            try:
                winsound.PlaySound("SystemAsterisk", winsound.SND_ALIAS)
            except:
                print("ğŸ”” *ding*")
    
    def check_inbox(self, folder_name=None):
        """Check inbox for new emails"""
        try:
            if folder_name:
                # Check shared mailbox - Try multiple methods
                inbox = None
                
                try:
                    inbox = self.namespace.Folders(folder_name).Folders("Inbox")
                    print(f"ğŸ” Checking {folder_name}...")
                except Exception as e1:
                    try:
                        inbox = self.namespace.Folders.Item(folder_name).Folders("Inbox")
                        print(f"ğŸ” Checking {folder_name}...")
                    except Exception as e2:
                        print(f"   ğŸ” Searching for folder '{folder_name}'...")
                        for folder in self.namespace.Folders:
                            if folder.Name.lower() == folder_name.lower():
                                inbox = folder.Folders("Inbox")
                                print(f"   âœ… Found folder: {folder.Name}")
                                break
                
                if not inbox:
                    print(f"âŒ Could not access mailbox: {folder_name}")
                    return
                    
                mailbox_key = folder_name
            else:
                inbox = self.namespace.GetDefaultFolder(6)
                mailbox_key = "primary"
                print(f"ğŸ” Checking {self.primary_email}...")
            
            now = datetime.now()
            
            if mailbox_key not in self.last_check_time:
                self.last_check_time[mailbox_key] = now - timedelta(seconds=self.check_interval)
                display_name = folder_name if folder_name else f"{self.primary_email} (Primary Inbox)"
                print(f"ğŸ“¬ Monitoring: {display_name}")
                print(f"â° Will notify for emails received after: {self.last_check_time[mailbox_key].strftime('%H:%M:%S')}")
                return
            
            messages = inbox.Items
            messages.Sort("[ReceivedTime]", True)
            
            unread_count = 0
            for msg in messages:
                try:
                    if msg.UnRead:
                        unread_count += 1
                except:
                    pass
            
            print(f"   ğŸ“Š Total unread: {unread_count}")
            
            new_count = 0
            for message in messages:
                try:
                    if message.UnRead:
                        received_time = message.ReceivedTime
                        
                        if not isinstance(received_time, datetime):
                            try:
                                received_time = datetime.strptime(str(received_time), '%Y-%m-%d %H:%M:%S')
                            except:
                                continue
                        
                        if received_time > self.last_check_time[mailbox_key]:
                            print(f"   âœ… NEW EMAIL: {message.Subject[:40]}")
                            self.show_notification(
                                message.Subject,
                                message.SenderName,
                                folder_name
                            )
                            new_count += 1
                except:
                    continue
            
            if new_count > 0:
                self.play_notification_sound()
            else:
                print(f"   â„¹ï¸  No new emails")
            
            self.last_check_time[mailbox_key] = now
            print("")
            
        except Exception as e:
            print(f"âŒ Error: {e}")
    
    def monitor(self):
        """Main monitoring loop"""
        if not self.connect_outlook():
            return
        
        print(f"\nğŸš€ Starting email monitor...")
        print(f"â±ï¸  Check interval: {self.check_interval} seconds")
        print(f"ğŸ“§ Monitoring: {self.primary_email} (Primary Inbox)")
        for mailbox in self.shared_mailboxes:
            print(f"ğŸ“§ Monitoring: {mailbox} (Shared Mailbox)")
        print("\nâŒ¨ï¸  Press Ctrl+C to stop\n")
        
        try:
            while True:
                self.check_inbox()
                
                for mailbox in self.shared_mailboxes:
                    self.check_inbox(mailbox)
                
                time.sleep(self.check_interval)
                
        except KeyboardInterrupt:
            print("\n\nâ¹ï¸  Monitor stopped")
        except Exception as e:
            print(f"\nâŒ Error: {e}")

def main():
    print("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         OUTLOOK EMAIL NOTIFIER                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    """)
    
    monitor = OutlookMonitor()
    monitor.monitor()

if __name__ == "__main__":
    main()
